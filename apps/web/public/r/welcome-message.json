{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "welcome-message",
  "type": "registry:component",
  "title": "AgentStart Welcome Message",
  "description": "Display welcome description and initial suggestions for new conversations with send-on-click behavior.",
  "dependencies": [
    "@phosphor-icons/react",
    "@tanstack/react-query",
    "agentstart",
    "motion",
    "react"
  ],
  "registryDependencies": [
    "@coss/button",
    "spinner",
    "conversation"
  ],
  "files": [
    {
      "path": "src/registry/agentstart/welcome-message.tsx",
      "content": "/* agent-frontmatter:start\nAGENT: Welcome message UI component\nPURPOSE: Display welcome description and initial suggestions for new conversations\nUSAGE: Import and render in conversation empty state to show agent introduction\nEXPORTS: WelcomeMessage, WelcomeMessageProps\nFEATURES:\n  - Fetches welcome configuration from the API\n  - Shows agent description and initial suggestions\n  - Click to send suggestion as new message\n  - Auto-hides when conversation starts\n  - Multi-store support via threadId\nSEARCHABLE: welcome message, initial suggestions, agent intro, empty state\nagent-frontmatter:end */\n\n\"use client\";\n\nimport { ArrowUpRightIcon } from \"@phosphor-icons/react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport type { AgentStartUIMessage } from \"agentstart/agent\";\nimport type { AgentStore } from \"agentstart/client\";\nimport {\n  getAgentStore,\n  useAgentStartContext,\n  useAgentStore,\n  useStoreRegistry,\n} from \"agentstart/client\";\nimport { AnimatePresence, motion } from \"motion/react\";\nimport { useMemo, useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Spinner } from \"@/components/ui/spinner\";\nimport { ConversationMessage } from \"./conversation/conversation-message\";\n\ntype UIAgentStore = AgentStore<AgentStartUIMessage>;\n\nexport type WelcomeMessageProps = {\n  className?: string;\n};\n\nexport function WelcomeMessage({ className }: WelcomeMessageProps) {\n  const { orpc, threadId, setThreadId, navigate } = useAgentStartContext();\n  const queryClient = useQueryClient();\n  const storeInstances = useStoreRegistry();\n\n  const storeId = threadId ?? \"default\";\n\n  const sendMessage = useAgentStore<\n    AgentStartUIMessage,\n    UIAgentStore[\"sendMessage\"]\n  >((state) => state.sendMessage, storeId);\n  const messages = useAgentStore<AgentStartUIMessage, AgentStartUIMessage[]>(\n    (state) => state.messages,\n    storeId,\n  );\n  const setNewThreadDraft = useAgentStore((state) => state.setNewThreadDraft);\n  const status = useAgentStore((state) => state.status, storeId);\n\n  const [sendingSuggestion, setSendingSuggestion] = useState<string | null>(\n    null,\n  );\n\n  const createThreadMutation = useMutation(\n    orpc.thread.create.mutationOptions(),\n  );\n\n  const isLoading =\n    status === \"submitted\" ||\n    status === \"streaming\" ||\n    createThreadMutation?.isPending;\n\n  // Use config from context (fetched once at provider level)\n  const { config: appConfig } = useAgentStartContext();\n\n  const handleSuggestionClick = async (suggestion: string) => {\n    setSendingSuggestion(suggestion);\n\n    // If no threadId (on homepage), create thread first\n    if (!threadId) {\n      try {\n        const trimmedText = suggestion.trim();\n        setNewThreadDraft({\n          text: trimmedText,\n        });\n\n        const { threadId: newThreadId } =\n          await createThreadMutation.mutateAsync({\n            visibility: \"public\",\n          });\n\n        // Update context state (single source of truth)\n        setThreadId(newThreadId);\n\n        queryClient.invalidateQueries(\n          orpc.thread.list.queryOptions({ input: {} }),\n        );\n\n        navigate(`/thread/${newThreadId}`);\n\n        const newStore = getAgentStore(storeInstances, newThreadId);\n        newStore.getState().sendMessage(\n          { text: suggestion },\n          {\n            body: {\n              threadId: newThreadId,\n            },\n          },\n        );\n      } catch (error) {\n        console.error(\"[WelcomeMessage] Failed to create thread:\", error);\n      } finally {\n        setSendingSuggestion(null);\n      }\n    } else {\n      // Has threadId, send message directly\n      try {\n        navigate(`/thread/${threadId}`);\n        await sendMessage(\n          { text: suggestion },\n          {\n            body: {\n              threadId,\n            },\n          },\n        );\n      } finally {\n        setSendingSuggestion(null);\n      }\n    }\n  };\n\n  const welcomeConfig = appConfig?.welcome;\n  const logo = appConfig?.logo;\n\n  const hasLogo = Boolean(logo);\n  const hasDescription = Boolean(welcomeConfig?.description);\n  const hasSuggestions =\n    Boolean(welcomeConfig?.suggestions) &&\n    Array.isArray(welcomeConfig?.suggestions) &&\n    welcomeConfig.suggestions.length > 0;\n\n  // Construct a mock message for the welcome (with description or just logo)\n  const welcomeMessage: AgentStartUIMessage = useMemo(\n    () => ({\n      id: \"welcome-message\",\n      role: \"assistant\",\n      parts: hasDescription\n        ? [{ type: \"text\", text: welcomeConfig?.description ?? \"\" }]\n        : [],\n    }),\n    [hasDescription, welcomeConfig?.description],\n  );\n\n  // Don't show if there are messages or welcome is not enabled\n  if (messages.length > 0 || !welcomeConfig?.enabled) {\n    return null;\n  }\n\n  // Need at least logo or description or suggestions\n  if (!hasLogo && !hasDescription && !hasSuggestions) {\n    return null;\n  }\n\n  return (\n    <AnimatePresence mode=\"wait\">\n      <div className={className}>\n        {(hasLogo || hasDescription) && (\n          <motion.div\n            key=\"welcome-message\"\n            initial={{ opacity: 0, y: 12 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: 12 }}\n            transition={{ duration: 0.3, ease: \"easeOut\" }}\n          >\n            <ConversationMessage\n              message={welcomeMessage}\n              isLastMessage={false}\n              status=\"ready\"\n              regenerate={async () => {}}\n            />\n          </motion.div>\n        )}\n\n        {hasSuggestions && welcomeConfig.suggestions && (\n          <motion.div\n            key=\"welcome-suggestions\"\n            initial={{ opacity: 0, y: 12 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: 12 }}\n            transition={{ duration: 0.3, ease: \"easeOut\", delay: 0.1 }}\n            className=\"mt-2 flex flex-col gap-2\"\n          >\n            <div className=\"w-fit px-0.5 text-muted-foreground text-sm\">\n              Try asking:\n            </div>\n            <div className=\"flex flex-wrap items-center gap-2\">\n              {welcomeConfig.suggestions.map(\n                (suggestion: string, index: number) => (\n                  <motion.div\n                    key={suggestion}\n                    initial={{ opacity: 0, y: 10 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    exit={{ opacity: 0, scale: 0.95 }}\n                    transition={{\n                      duration: 0.2,\n                      delay: 0.1 + index * 0.05,\n                      ease: \"easeOut\",\n                    }}\n                  >\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleSuggestionClick(suggestion)}\n                      disabled={isLoading}\n                    >\n                      {sendingSuggestion === suggestion && <Spinner />}\n                      {suggestion}\n                      <ArrowUpRightIcon className=\"size-3\" weight=\"bold\" />\n                    </Button>\n                  </motion.div>\n                ),\n              )}\n            </div>\n          </motion.div>\n        )}\n      </div>\n    </AnimatePresence>\n  );\n}\n",
      "type": "registry:component",
      "target": "components/agent/welcome-message.tsx"
    }
  ]
}