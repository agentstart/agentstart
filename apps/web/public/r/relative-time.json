{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "relative-time",
  "type": "registry:component",
  "title": "AgentStart Relative Time",
  "description": "Human-readable relative timestamps with tooltip showing UTC/local details and auto-updates.",
  "dependencies": [
    "date-fns",
    "react"
  ],
  "registryDependencies": [
    "@coss/badge",
    "@coss/tooltip"
  ],
  "files": [
    {
      "path": "src/registry/agentstart/relative-time.tsx",
      "content": "/* agent-frontmatter:start\nAGENT: Relative time display component\nPURPOSE: Display human-readable relative timestamps with detailed tooltip\nUSAGE: <RelativeTime timestamp={timestamp} />\nEXPORTS: RelativeTime, RelativeTimeProps\nFEATURES:\n  - Displays simple relative time in trigger (e.g., \"2 days ago\")\n  - Shows detailed relative time in tooltip (e.g., \"2 days, 12 hours ago\")\n  - Shows UTC and local timezone in tooltip on hover\n  - Auto-updates every minute\n  - Handles Date objects and Unix timestamps\nSEARCHABLE: relative time, timestamp, time display, date formatting, timezone\nagent-frontmatter:end */\n\n\"use client\";\n\nimport { format, intervalToDuration } from \"date-fns\";\nimport type { ComponentProps, ReactNode } from \"react\";\nimport { useEffect, useMemo, useState } from \"react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tooltip, TooltipPopup, TooltipTrigger } from \"@/components/ui/tooltip\";\n\nexport type RelativeTimeProps = {\n  /**\n   * Custom element to render before the time\n   */\n  leading?: ReactNode;\n  timestamp?: number | Date;\n} & Omit<ComponentProps<typeof TooltipTrigger>, \"children\">;\n\n/**\n * Calculate simple relative time (only the most significant unit)\n */\nfunction formatSimpleRelativeTime(date: Date): string {\n  const now = new Date();\n  const duration = intervalToDuration({ start: date, end: now });\n\n  // Return only the most significant time unit\n  if (duration.years && duration.years > 0) {\n    return `${duration.years} year${duration.years > 1 ? \"s\" : \"\"} ago`;\n  }\n  if (duration.months && duration.months > 0) {\n    return `${duration.months} month${duration.months > 1 ? \"s\" : \"\"} ago`;\n  }\n  if (duration.days && duration.days > 0) {\n    return `${duration.days} day${duration.days > 1 ? \"s\" : \"\"} ago`;\n  }\n  if (duration.hours && duration.hours > 0) {\n    return `${duration.hours} hour${duration.hours > 1 ? \"s\" : \"\"} ago`;\n  }\n  if (duration.minutes && duration.minutes > 0) {\n    return `${duration.minutes} minute${duration.minutes > 1 ? \"s\" : \"\"} ago`;\n  }\n  if (duration.seconds && duration.seconds > 0) {\n    return `${duration.seconds} second${duration.seconds > 1 ? \"s\" : \"\"} ago`;\n  }\n\n  return \"just now\";\n}\n\n/**\n * Calculate detailed relative time using date-fns intervalToDuration\n */\nfunction formatDetailedRelativeTime(date: Date): string {\n  const now = new Date();\n  const duration = intervalToDuration({ start: date, end: now });\n\n  const parts: string[] = [];\n\n  // Add up to 3 most significant time units\n  if (duration.years && duration.years > 0) {\n    parts.push(`${duration.years} year${duration.years > 1 ? \"s\" : \"\"}`);\n  }\n  if (duration.months && duration.months > 0 && parts.length < 3) {\n    parts.push(`${duration.months} month${duration.months > 1 ? \"s\" : \"\"}`);\n  }\n  if (duration.days && duration.days > 0 && parts.length < 3) {\n    parts.push(`${duration.days} day${duration.days > 1 ? \"s\" : \"\"}`);\n  }\n  if (duration.hours && duration.hours > 0 && parts.length < 3) {\n    parts.push(`${duration.hours} hour${duration.hours > 1 ? \"s\" : \"\"}`);\n  }\n  if (duration.minutes && duration.minutes > 0 && parts.length < 3) {\n    parts.push(`${duration.minutes} minute${duration.minutes > 1 ? \"s\" : \"\"}`);\n  }\n  if (duration.seconds && duration.seconds > 0 && parts.length < 3) {\n    parts.push(`${duration.seconds} second${duration.seconds > 1 ? \"s\" : \"\"}`);\n  }\n\n  return parts.length > 0 ? `${parts.join(\", \")} ago` : \"just now\";\n}\n\n/**\n * Get timezone offset string (e.g., \"GMT+8\", \"UTC\")\n */\nfunction getTimezoneString(): string {\n  const offset = -new Date().getTimezoneOffset();\n  if (offset === 0) return \"UTC\";\n\n  const hours = Math.floor(Math.abs(offset) / 60);\n  const minutes = Math.abs(offset) % 60;\n  const sign = offset >= 0 ? \"+\" : \"-\";\n\n  return `GMT${sign}${hours}${minutes > 0 ? `:${minutes.toString().padStart(2, \"0\")}` : \"\"}`;\n}\n\nexport const RelativeTime = ({\n  leading,\n  timestamp,\n  className,\n  ...props\n}: RelativeTimeProps) => {\n  const [simpleRelativeTime, setSimpleRelativeTime] = useState<string>(\"\");\n  const [detailedRelativeTime, setDetailedRelativeTime] = useState<string>(\"\");\n\n  // Format detailed time info for tooltip\n  const timeInfo = useMemo(() => {\n    if (!timestamp) return null;\n\n    const date = new Date(timestamp);\n    const utcDate = format(date, \"MMMM d, yyyy\");\n    const utcTime = format(date, \"hh:mm:ss a\");\n    const localDate = format(date, \"MMMM d, yyyy\");\n    const localTime = format(date, \"hh:mm:ss a\");\n    const timezone = getTimezoneString();\n\n    return {\n      utcDate,\n      utcTime,\n      localDate,\n      localTime,\n      timezone,\n    };\n  }, [timestamp]);\n\n  // Update relative times periodically\n  useEffect(() => {\n    if (!timestamp) {\n      setSimpleRelativeTime(\"\");\n      setDetailedRelativeTime(\"\");\n      return;\n    }\n\n    const updateRelativeTimes = () => {\n      const date = new Date(timestamp);\n      setSimpleRelativeTime(formatSimpleRelativeTime(date));\n      setDetailedRelativeTime(formatDetailedRelativeTime(date));\n    };\n\n    updateRelativeTimes();\n    const interval = setInterval(updateRelativeTimes, 60000); // Update every minute\n\n    return () => clearInterval(interval);\n  }, [timestamp]);\n\n  if (!timestamp || !simpleRelativeTime || !timeInfo) {\n    return null;\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger\n        className={className ?? \"cursor-default text-muted-foreground text-xs\"}\n        {...props}\n      >\n        {leading} {simpleRelativeTime}\n      </TooltipTrigger>\n      <TooltipPopup>\n        <div className=\"space-y-2 text-xs\">\n          {/* Detailed relative time at the top */}\n          <div className=\"text-left\">{detailedRelativeTime}</div>\n\n          {/* UTC and local timezone */}\n          <div className=\"space-y-1\">\n            <div className=\"flex items-center justify-between gap-4\">\n              <div className=\"flex items-center gap-1\">\n                <Badge variant=\"secondary\">UTC</Badge>\n                <div>{timeInfo.utcDate}</div>\n              </div>\n              <div className=\"text-right\">\n                <div className=\"text-muted-foreground\">{timeInfo.utcTime}</div>\n              </div>\n            </div>\n            <div className=\"flex items-center justify-between gap-4\">\n              <div className=\"flex items-center gap-1\">\n                <Badge variant=\"secondary\">{timeInfo.timezone}</Badge>\n                <div>{timeInfo.localDate}</div>\n              </div>\n              <div className=\"text-right\">\n                <div className=\"text-muted-foreground\">\n                  {timeInfo.localTime}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </TooltipPopup>\n    </Tooltip>\n  );\n};\n",
      "type": "registry:component",
      "target": "components/agent/relative-time.tsx"
    }
  ]
}