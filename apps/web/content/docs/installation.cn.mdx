---
title: å®‰è£…
description: å­¦ä¹ å¦‚ä½•åœ¨é¡¹ç›®ä¸­é…ç½® AgentStart
---

<Steps>

<Step>

### å®‰è£…åŒ…

è®©æˆ‘ä»¬ä»å°† AgentStart æ·»åŠ åˆ°æ‚¨çš„é¡¹ç›®å¼€å§‹ï¼š

```bash
npm install agentstart
```

<Callout type="info">
å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯å•ç‹¬çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨è®¾ç½®ï¼Œè¯·ç¡®ä¿åœ¨é¡¹ç›®çš„ä¸¤ä¸ªéƒ¨åˆ†éƒ½å®‰è£… AgentStartã€‚
</Callout>

</Step>

<Step>

### è®¾ç½®ç¯å¢ƒå˜é‡

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶å¹¶æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

1. **æ¨¡å‹æä¾›å•† API å¯†é’¥**

æ¥è‡ªæ‚¨çš„æ¨¡å‹æä¾›å•†ï¼ˆOpenRouterã€OpenAIã€Anthropic ç­‰ï¼‰çš„ API å¯†é’¥ã€‚

```txt title=".env"
MODEL_PROVIDER_API_KEY=your_api_key_here
```

2. **æ•°æ®åº“ URL**

æ‚¨çš„æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼š

```txt title=".env"
DATABASE_URL=postgresql://user:password@localhost:5432/dbname
```

</Step>

<Step>

### å®‰è£…æ¨¡å‹æä¾›å•†

é€‰æ‹©å¹¶å®‰è£…æ‚¨å–œæ¬¢çš„ AI æ¨¡å‹æä¾›å•†ï¼š

<Tabs items={["OpenRouter", "OpenAI", "Anthropic"]}>
  <Tab value="OpenRouter">
    ```bash
    npm install @openrouter/ai-sdk-provider
    ```
    
    ä» [OpenRouter](https://openrouter.ai/keys) è·å–æ‚¨çš„ API å¯†é’¥
  </Tab>
  
  <Tab value="OpenAI">
    ```bash
    npm install @ai-sdk/openai
    ```
    
    ä» [OpenAI Platform](https://platform.openai.com/api-keys) è·å–æ‚¨çš„ API å¯†é’¥
  </Tab>
  
  <Tab value="Anthropic">
    ```bash
    npm install @ai-sdk/anthropic
    ```
    
    ä» [Anthropic Console](https://console.anthropic.com/) è·å–æ‚¨çš„ API å¯†é’¥
  </Tab>
</Tabs>

</Step>

<Step>

### é…ç½®æ•°æ®åº“

é€‰æ‹©æ‚¨çš„æ•°æ®åº“é€‚é…å™¨å¹¶å®‰è£…ä¾èµ–ï¼š

<Tabs items={["Drizzle", "Prisma", "Kysely", "MongoDB"]}>
  <Tab value="Drizzle">
    ```bash
    npm install drizzle-orm @neondatabase/serverless
    ```
    
    åˆ›å»ºæ‚¨çš„æ•°æ®åº“æ¶æ„ï¼š
    
    ```ts title="db/schema/agent.ts"
    import { pgTable, text, timestamp, jsonb } from "drizzle-orm/pg-core";

    export const threadsTable = pgTable("threads", {
      id: text("id").primaryKey(),
      title: text("title"),
      userId: text("user_id"),
      createdAt: timestamp("created_at").defaultNow(),
      metadata: jsonb("metadata"),
    });

    export const messagesTable = pgTable("messages", {
      id: text("id").primaryKey(),
      threadId: text("thread_id").references(() => threadsTable.id),
      role: text("role"),
      content: text("content"),
      createdAt: timestamp("created_at").defaultNow(),
      metadata: jsonb("metadata"),
    });
    ```
    
    åˆå§‹åŒ– Drizzleï¼š
    
    ```ts title="db/index.ts"
    import { drizzle } from "drizzle-orm/neon-http";
    import { neon } from "@neondatabase/serverless";

    const sql = neon(process.env.DATABASE_URL!);
    export const db = drizzle(sql);
    ```
  </Tab>
  
  <Tab value="Prisma">
    ```bash
    npm install @prisma/client
    npm install -D prisma
    ```
    
    å®šä¹‰æ‚¨çš„æ¶æ„ï¼š
    
    ```prisma title="prisma/schema.prisma"
    model Thread {
      id        String    @id @default(cuid())
      title     String?
      userId    String?
      createdAt DateTime  @default(now())
      messages  Message[]
      metadata  Json?
    }

    model Message {
      id        String   @id @default(cuid())
      threadId  String
      thread    Thread   @relation(fields: [threadId], references: [id])
      role      String
      content   String
      createdAt DateTime @default(now())
      metadata  Json?
    }
    ```
    
    ç”Ÿæˆ Prisma å®¢æˆ·ç«¯ï¼š
    
    ```bash
    npx prisma generate
    npx prisma db push
    ```
  </Tab>
  
  <Tab value="Kysely">
    ```bash
    npm install kysely pg
    ```
    
    å®šä¹‰æ‚¨çš„ç±»å‹å¹¶åˆå§‹åŒ–ï¼š
    
    ```ts title="db/index.ts"
    import { Kysely, PostgresDialect } from "kysely";
    import { Pool } from "pg";

    export const db = new Kysely({
      dialect: new PostgresDialect({
        pool: new Pool({
          connectionString: process.env.DATABASE_URL,
        }),
      }),
    });
    ```
  </Tab>
  
  <Tab value="MongoDB">
    ```bash
    npm install mongodb
    ```
    
    åˆå§‹åŒ– MongoDB å®¢æˆ·ç«¯ï¼š
    
    ```ts title="db/index.ts"
    import { MongoClient } from "mongodb";

    const client = new MongoClient(process.env.DATABASE_URL!);
    await client.connect();

    export const db = client.db("agentstart");
    ```
  </Tab>
</Tabs>

</Step>

<Step>

### åˆ›å»º Agent å®ä¾‹

åœ¨ä»¥ä¸‹ä½ç½®ä¹‹ä¸€åˆ›å»ºåä¸º `agent.ts` çš„æ–‡ä»¶ï¼š
- `lib/agent.ts`
- `src/lib/agent.ts`
- `server/agent.ts`

```ts title="lib/agent.ts"
import { createOpenRouter } from "@openrouter/ai-sdk-provider";
import { agentStart } from "agentstart";
import { Agent, innerTools, osTools } from "agentstart/agent";
import { drizzleAdapter } from "agentstart/db";
import { db } from "@/db";
import * as schema from "@/db/schema";

const openrouter = createOpenRouter({
  apiKey: process.env.MODEL_PROVIDER_API_KEY!,
});

const agent = new Agent({
  model: openrouter("x-ai/grok-4-fast"),
  instructions: "ä½ æ˜¯ä¸€ä¸ªä¹äºåŠ©äººçš„åŠ©æ‰‹ã€‚",
  tools: {
    ...innerTools,
    ...osTools,
  },
});

export const start = agentStart({
  agent,
  memory: drizzleAdapter(db, {
    provider: "pg",
    schema: {
      thread: schema.threadsTable,
      message: schema.messagesTable,
    },
  }),
  appName: "my-app",
});
```

</Step>

<Step>

### æŒ‚è½½å¤„ç†å™¨

åˆ›å»ºä¸€ä¸ª API è·¯ç”±æ¥å¤„ç†æ™ºèƒ½ä½“è¯·æ±‚ã€‚è¯¥è·¯ç”±åº”å¤„ç†è·¯å¾„ `/api/agent/*` çš„è¯·æ±‚ã€‚

<Tabs items={["Next.js", "Express", "Node.js"]}>
  <Tab value="Next.js">
    ```ts title="app/api/agent/[...all]/route.ts"
    import { toNextJsHandler } from "agentstart/integration";
    import { start } from "@/lib/agent";

    export const { POST, GET } = toNextJsHandler(start.handler);
    ```
  </Tab>
  
  <Tab value="Express">
    ```ts title="server.ts"
    import express from "express";
    import { toNodeHandler } from "agentstart/integration";
    import { start } from "./lib/agent";

    const app = express();
    const handler = toNodeHandler(start.handler);

    app.use("/api/agent", handler);

    app.listen(3000, () => {
      console.log("æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3000");
    });
    ```
  </Tab>
  
  <Tab value="Node.js">
    ```ts title="server.ts"
    import { createServer } from "node:http";
    import { toNodeHandler } from "agentstart/integration";
    import { start } from "./lib/agent";

    const handler = toNodeHandler(start.handler);
    const server = createServer(handler);

    server.listen(3000, () => {
      console.log("æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:3000");
    });
    ```
  </Tab>
</Tabs>

</Step>

<Step>

### åˆ›å»ºå®¢æˆ·ç«¯å®ä¾‹

åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ä»¥ä»å‰ç«¯ä¸æ‚¨çš„æ™ºèƒ½ä½“äº¤äº’ï¼š

```ts title="lib/agent-client.ts"
import { createAgentClient } from "agentstart/client";

export const { client, useThread } = createAgentClient({
  baseURL: "http://localhost:3000", // å¦‚æœåœ¨åŒä¸€åŸŸååˆ™å¯é€‰
});
```

<Callout type="info">
å¦‚æœæ‚¨çš„æ™ºèƒ½ä½“ä¸å‰ç«¯è¿è¡Œåœ¨åŒä¸€åŸŸåï¼Œæ‚¨å¯ä»¥çœç•¥ `baseURL` é€‰é¡¹ã€‚
</Callout>

</Step>

<Step>

### ğŸ‰ å®Œæˆï¼

æ‚¨ç°åœ¨å·²å‡†å¤‡å¥½åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ AgentStartã€‚ç»§ç»­é˜…è¯»[åŸºæœ¬ç”¨æ³•](/cn/docs/basic-usage)ä»¥äº†è§£å¦‚ä½•åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨æ™ºèƒ½ä½“ã€‚

</Step>

</Steps>

## æ•°æ®åº“è¿ç§»

è®¾ç½®æ¶æ„åï¼Œè¿è¡Œè¿ç§»ä»¥åˆ›å»ºè¡¨ï¼š

<Tabs items={["Drizzle", "Prisma"]}>
  <Tab value="Drizzle">
    ```bash
    npx drizzle-kit generate
    npx drizzle-kit push
    ```
  </Tab>
  
  <Tab value="Prisma">
    ```bash
    npx prisma generate
    npx prisma db push
    ```
  </Tab>
</Tabs>

## ç¤ºä¾‹é¡¹ç›®

æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹ï¼š

- **Next.js ç¤ºä¾‹**ï¼šæŸ¥çœ‹ä»“åº“ä¸­çš„ `/playground/next`
- **Express ç¤ºä¾‹**ï¼šå³å°†æ¨å‡º

## ä¸‹ä¸€æ­¥

<Cards>
  <Card title="åŸºæœ¬ç”¨æ³•" href="/docs/basic-usage" />
  <Card title="æ•°æ®åº“" href="/docs/concepts/database" />
  <Card title="å·¥å…·" href="/docs/concepts/tools" />
</Cards>
