---
title: Next.js Integration
description: Integrate AgentStart with Next.js App Router
---

AgentStart can be easily integrated with Next.js. It shares the same App Router flow as Better Auth—swap in the agent handler, wire up the client, and you’re ready to stream conversations.

Before you start, make sure you have an AgentStart instance configured. If you haven't done that yet, check out the [installation](/docs/installation).

### Create API Route

We need to mount the handler to an API route. Create a route file inside the `/api/agent/[...all]` directory and add the following code:

```ts title="app/api/agent/[...all]/route.ts"
import { toNextJsHandler } from "agentstart/integration";
import { start } from "@/lib/agent";

export const { GET, POST } = toNextJsHandler(start.handler);
```

<Callout type="info">
 You can change the path in your `agentStart` configuration, but it’s recommended to keep it as `/api/agent/[...all]` so the generated hooks and clients continue to work.
</Callout>

For the legacy `pages` router, use the Node.js handler instead of `toNextJsHandler` and disable the body parser:

```ts title="pages/api/agent/[...all].ts"
import { toNodeHandler } from "agentstart/integration";
import { start } from "@/lib/agent";

export const config = { api: { bodyParser: false } };

export default toNodeHandler(start.handler);
```

## Create a client

Create a client instance. You can name the file anything you want—here we use `lib/agent-client.ts`.

```ts title="lib/agent-client.ts"
import { createAgentClient } from "agentstart/client";

export const { client, useThread } = createAgentClient();
```

Once you have created the client, you can use it to send messages, create threads, and stream responses in React components. The client stores state with Zustand, so updates are reactive by default.

## RSC and Server actions

The `start.api` object exported from the agent instance contains all the actions that you can perform on the server. Every endpoint is invocable as a function, including custom tools.

**Example: Loading a thread in a server action**

```tsx title="app/actions/get-thread.ts"
"use server";

import { headers } from "next/headers";
import { start } from "@/lib/agent";

export async function getThread(threadId: string) {
  return start.api.thread.loadMessages(
    { threadId },
    { headers: await headers() },
  );
}
```

**Example: Using agent data inside an RSC**

```tsx
"use server";

import { headers } from "next/headers";
import { start } from "@/lib/agent";

export async function ThreadSummary({ threadId }: { threadId: string }) {
  const { thread } = await start.api.thread.get(
    { threadId },
    { headers: await headers() },
  );

  if (!thread) {
    return <div>No thread found.</div>;
  }

  return (
    <div>
      <h1>{thread.title}</h1>
      <p>Last updated: {thread.updatedAt.toLocaleString()}</p>
    </div>
  );
}
```
