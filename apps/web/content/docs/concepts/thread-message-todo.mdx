---
title: Thread, Message & Todo
description: Understanding core data models in AgentStart
---

# Thread, Message & Todo

AgentStart organizes agent interactions using three core data models: Threads, Messages, and Todos.

## Threads

A **Thread** represents a conversation session between a user and an agent. Each thread maintains its own context and history.

### Thread Structure

```ts
interface Thread {
  id: string;
  title: string | null;
  userId: string | null;
  createdAt: Date;
  metadata: unknown;
}
```

### Creating Threads

```ts
// Server-side
const thread = await start.api.thread.create({
  title: "Help with TypeScript",
  userId: "user-123",
});

// Client-side
const thread = await client.thread.create({
  title: "Help with TypeScript",
});
```

### Listing Threads

```ts
// Get all threads for current user
const threads = await start.api.thread.list();

// Filter by user
const userThreads = await start.api.thread.list({ 
  userId: "user-123" 
});
```

### Deleting Threads

```ts
await start.api.thread.delete({ id: "thread-123" });
```

## Messages

**Messages** are individual exchanges within a thread. Each message has a role (user, assistant, system, or tool).

### Message Structure

```ts
interface Message {
  id: string;
  threadId: string;
  role: "user" | "assistant" | "system" | "tool";
  content: string;
  createdAt: Date;
  metadata: unknown;
}
```

### Message Roles

- **user**: Messages from the user
- **assistant**: Responses from the AI agent
- **system**: System prompts and instructions
- **tool**: Tool execution results

### Sending Messages

```tsx
// Client-side with hooks
const sendMessage = useAgentStore((state) => state.sendMessage, threadId);
await sendMessage({ content: "What is TypeScript?" });

// Server-side
await start.api.message.send({
  threadId: "thread-123",
  content: "What is TypeScript?",
});
```

### Getting Messages

```tsx
// Client-side
const messages = useAgentStore((state) => state.messages, threadId);

// Server-side
const messages = await start.api.message.list({ 
  threadId: "thread-123" 
});
```

### Message Streaming

Messages are streamed in real-time using Server-Sent Events:

```tsx
const isStreaming = useAgentStore((state) => state.isStreaming, threadId);

{isStreaming && <StreamingIndicator />}
```

## Todos

**Todos** help agents track tasks and sub-goals within a thread. The agent can read and update todos using built-in tools.

### Todo Structure

```ts
interface Todo {
  id: string;
  content: string;
  status: "pending" | "in_progress" | "completed";
  priority: "low" | "medium" | "high";
}
```

### Reading Todos

Agents use the `todoRead` tool to check current tasks:

```ts
// The agent automatically has access to this tool
const todos = await start.api.todo.read({ threadId: "thread-123" });
```

### Writing Todos

Agents use the `todoWrite` tool to update tasks:

```ts
await start.api.todo.write({
  threadId: "thread-123",
  todos: [
    {
      id: "1",
      content: "Research TypeScript types",
      status: "completed",
      priority: "high",
    },
    {
      id: "2",
      content: "Write documentation",
      status: "in_progress",
      priority: "medium",
    },
  ],
});
```

### Todo Example

```tsx
"use client";

import { useAgentStore } from "@/lib/agent-client";

export function TodoList({ threadId }: { threadId: string }) {
  const [todos, setTodos] = useState<Todo[]>([]);

  // Fetch todos
  useEffect(() => {
    async function fetchTodos() {
      const result = await client.todo.read({ threadId });
      setTodos(result);
    }
    fetchTodos();
  }, [threadId]);

  return (
    <div>
      <h3>Agent Tasks</h3>
      {todos.map((todo) => (
        <div key={todo.id}>
          <span className={todo.status === "completed" ? "line-through" : ""}>
            {todo.content}
          </span>
          <span>{todo.status}</span>
        </div>
      ))}
    </div>
  );
}
```

## Relationships

```
Thread (1)
  ├── Messages (many)
  │   ├── User messages
  │   ├── Assistant messages
  │   └── Tool messages
  └── Todos (many)
      ├── Pending tasks
      ├── In-progress tasks
      └── Completed tasks
```

## Best Practices

### Thread Management

1. **Title threads descriptively** for easy identification
2. **Clean up old threads** to maintain performance
3. **Use metadata** to store custom thread data

### Message Handling

1. **Stream responses** for better UX
2. **Handle errors gracefully** with try-catch blocks
3. **Show loading states** during message sending

### Todo Organization

1. **Keep todos focused** - one clear task per todo
2. **Update status regularly** - helps the agent track progress
3. **Use priorities** - helps the agent decide what to do next

## Example: Complete Thread Lifecycle

```tsx
// 1. Create thread
const thread = await client.thread.create({
  title: "Build a React component",
});

// 2. Send initial message
await sendMessage({ 
  content: "Help me build a button component" 
});

// 3. Agent responds and creates todos
// Todos automatically tracked by agent using innerTools

// 4. Continue conversation
await sendMessage({ 
  content: "Add hover effects" 
});

// 5. Check progress
const todos = await client.todo.read({ threadId: thread.id });

// 6. Clean up when done
await client.thread.delete({ id: thread.id });
```

## Next Steps

<Cards>
  <Card title="API" href="/docs/concepts/api" />
  <Card title="Client" href="/docs/concepts/client" />
  <Card title="Database" href="/docs/concepts/database" />
</Cards>
